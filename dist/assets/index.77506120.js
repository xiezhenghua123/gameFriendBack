import{a as v,e as q,i as D}from"./gameManage.330b90d7.js";import{s as _}from"./user.6728ae69.js";import{_ as y,$ as k,o as j,p as C,H as a,S as o,C as l,q as U,J as f,I as n}from"./index.f70b805b.js";const Y={class:"upload-icon mr-10"},O=f("\u63D0\u4EA4"),$=f("\u53D6\u6D88"),N={emits:["confirm"],data(){return{level:[{label:"\u6821\u7EA7",value:"\u6821\u7EA7"},{label:"\u7701\u7EA7",value:"\u7701\u7EA7"},{label:"\u56FD\u5BB6\u7EA7",value:"\u56FD\u5BB6\u7EA7"}],subject:[{label:"\u7406\u79D1",value:"\u7406\u79D1"},{label:"\u5DE5\u79D1",value:"\u5DE5\u79D1"},{label:"\u6587\u79D1",value:"\u6587\u79D1"}],rules:{content:{required:!0,message:"\u8BF7\u586B\u5199\u8D5B\u4E8B\u8BE6\u60C5",trigger:"change"},img:{required:!0,message:"\u8BF7\u4E0A\u4F20\u6D77\u62A5",trigger:"change"},name:{required:!0,message:"\u8BF7\u8F93\u5165\u8D5B\u4E8B\u540D\u79F0",trigger:"change"},organizer:{required:!0,message:"\u8BF7\u8F93\u5165\u4E3B\u529E\u65B9",trigger:"change"},sign_up_time:{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u540D\u65F6\u95F4",trigger:"change"},game_time:{required:!0,message:"\u8BF7\u9009\u62E9\u6BD4\u8D5B\u65F6\u95F4",trigger:"change"},subject:{required:!0,message:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u79D1\u76EE",trigger:"change"},level:{required:!0,message:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u7EA7\u522B",trigger:"change"}},operation:"add"}},props:{initData:{type:Object},dialogVisible:{type:Boolean}},watch:{initData:{handler(s){if(JSON.stringify(s)!=="{}"){for(let e in s)e=="level"||e=="subject"?this.gameData.data[e]=[s[e]]:this.gameData.data=s;this.gameData.fileList=[{url:JSON.parse(s.img)[0]}],this.operation="edit"}else this.operation="add",this.gameData.data={},this.gameData.fileList=[]},immediate:!0}},methods:{cancel(){this.$emit("update:dialogVisible",!1)},clickAddGame(){this.$refs.gameRef.validate(s=>{if(s){const e={};for(let d in this.gameData.data)d=="img"?e[d]=JSON.stringify([this.gameData.data[d]]):e[d]=this.gameData.data[d].toString();e.publisher="1",this.operation==="add"?v(e).then(d=>{d.code===0&&(this.$emit("update:dialogVisible",!1),this.$emit("confirm",!0),_("\u53D1\u5E03\u6210\u529F"))}):q(e,e.id).then(d=>{d.code===0&&(this.$emit("update:dialogVisible",!1),this.$emit("confirm",!0),_("\u4FEE\u6539\u6210\u529F"))})}})}}},G=Object.assign(N,{setup(s){const e=k({data:{},fileList:[]}),d=u=>{D(u.file).then(({data:t})=>{e.data.img=t})};return(u,t)=>{const b=n("iconifyIconOnline"),h=n("el-upload"),r=n("el-form-item"),m=n("el-input"),p=n("el-date-picker"),g=n("el-cascader"),c=n("el-button"),V=n("el-form");return j(),C("div",null,[a(V,{ref:"gameRef",model:l(e).data,"label-width":"auto",rules:u.rules},{default:o(()=>[a(r,{label:"\u56FE\u7247\u4E0A\u4F20",prop:"img",required:""},{default:o(()=>[a(h,{class:"upload-demo flex",limit:1,name:"image",action:"","http-request":d,"file-list":l(e).fileList,"list-type":"picture"},{default:o(()=>[U("div",Y,[a(b,{icon:"plus"})])]),_:1},8,["file-list"])]),_:1}),a(r,{prop:"name",label:"\u8D5B\u4E8B\u540D\u79F0",required:""},{default:o(()=>[a(m,{modelValue:l(e).data.name,"onUpdate:modelValue":t[0]||(t[0]=i=>l(e).data.name=i)},null,8,["modelValue"])]),_:1}),a(r,{prop:"name",label:"\u4E3B\u529E\u65B9",required:""},{default:o(()=>[a(m,{modelValue:l(e).data.organizer,"onUpdate:modelValue":t[1]||(t[1]=i=>l(e).data.organizer=i)},null,8,["modelValue"])]),_:1}),a(r,{prop:"game_time",label:"\u6BD4\u8D5B\u65F6\u95F4",required:""},{default:o(()=>[a(p,{modelValue:l(e).data.game_time,"onUpdate:modelValue":t[2]||(t[2]=i=>l(e).data.game_time=i),type:"datetime",placeholder:"\u9009\u62E9\u6BD4\u8D5B\u65F6\u95F4","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),a(r,{prop:"sign_up_time",label:"\u62A5\u540D\u622A\u6B62\u65F6\u95F4",required:""},{default:o(()=>[a(p,{modelValue:l(e).data.sign_up_time,"onUpdate:modelValue":t[3]||(t[3]=i=>l(e).data.sign_up_time=i),placeholder:"\u9009\u62E9\u62A5\u540D\u622A\u6B62\u65F6\u95F4","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),a(r,{prop:"subject",label:"\u7ADE\u8D5B\u79D1\u76EE",required:""},{default:o(()=>[a(g,{modelValue:l(e).data.subject,"onUpdate:modelValue":t[4]||(t[4]=i=>l(e).data.subject=i),options:u.subject,placeholder:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u79D1\u76EE"},null,8,["modelValue","options"])]),_:1}),a(r,{prop:"level",label:"\u7ADE\u8D5B\u7EA7\u522B",required:""},{default:o(()=>[a(g,{modelValue:l(e).data.level,"onUpdate:modelValue":t[5]||(t[5]=i=>l(e).data.level=i),options:u.level,placeholder:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u7EA7\u522B"},null,8,["modelValue","options"])]),_:1}),a(r,{prop:"content",label:"\u8D5B\u4E8B\u8BE6\u60C5",required:""},{default:o(()=>[a(m,{modelValue:l(e).data.content,"onUpdate:modelValue":t[6]||(t[6]=i=>l(e).data.content=i),type:"textarea"},null,8,["modelValue"])]),_:1}),a(r,null,{default:o(()=>[a(c,{type:"primary",onClick:u.clickAddGame},{default:o(()=>[O]),_:1},8,["onClick"]),a(c,{type:"danger",onClick:u.cancel},{default:o(()=>[$]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])])}}});var B=y(G,[["__scopeId","data-v-7d168b14"]]);export{B as default};
