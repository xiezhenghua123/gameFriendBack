import{h as m,s as f}from"./user.320c1fa9.js";import{_ as q,$ as y,o as D,p as j,H as a,S as o,C as i,q as k,J as h,I as d}from"./index.571ac389.js";const $=t=>m.request("post","/game/add",{data:t}),z=t=>m.request("delete",`/game/${t}`),C=(t,e)=>m.request("put",`/game/${e}`,{data:t}),B=t=>m.request("get",`/game/list/${t}`),O=t=>{const e=new FormData;return e.append("image",t),t=e,m.request("post","/image",{data:t},{headers:{"Content-Type":"multipart/form-data"}})};const Y={class:"upload-icon mr-10"},G=h("\u63D0\u4EA4"),S=h("\u53D6\u6D88"),U={emits:["confirm"],data(){return{level:[{label:"\u6821\u7EA7",value:"\u6821\u7EA7"},{label:"\u7701\u7EA7",value:"\u7701\u7EA7"},{label:"\u56FD\u5BB6\u7EA7",value:"\u56FD\u5BB6\u7EA7"}],subject:[{label:"\u7406\u79D1",value:"\u7406\u79D1"},{label:"\u5DE5\u79D1",value:"\u5DE5\u79D1"},{label:"\u6587\u79D1",value:"\u6587\u79D1"}],rules:{img:{required:!0,message:"\u8BF7\u4E0A\u4F20\u6D77\u62A5",trigger:"change"},name:{required:!0,message:"\u8BF7\u8F93\u5165\u8D5B\u4E8B\u540D\u79F0",trigger:"change"},organizer:{required:!0,message:"\u8BF7\u8F93\u5165\u4E3B\u529E\u65B9",trigger:"change"},sign_up_time:{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u540D\u65F6\u95F4",trigger:"change"},game_time:{required:!0,message:"\u8BF7\u9009\u62E9\u6BD4\u8D5B\u65F6\u95F4",trigger:"change"},subject:{required:!0,message:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u79D1\u76EE",trigger:"change"},level:{required:!0,message:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u7EA7\u522B",trigger:"change"}},operation:"add"}},props:{initData:{type:Object},dialogVisible:{type:Boolean}},watch:{initData:{handler(t){if(JSON.stringify(t)!=="{}"){for(let e in t)e=="level"||e=="subject"?this.gameData.data[e]=[t[e]]:this.gameData.data=t;this.gameData.fileList=[{url:JSON.parse(t.img)[0]}],this.operation="edit"}else this.operation="add",this.gameData.data={},this.gameData.fileList=[]},immediate:!0}},methods:{cancel(){this.$emit("update:dialogVisible",!1)},clickAddGame(){this.$refs.gameRef.validate(t=>{if(t){const e={};for(let r in this.gameData.data)r=="img"?e[r]=JSON.stringify([this.gameData.data[r]]):e[r]=this.gameData.data[r].toString();e.publisher="1",this.operation==="add"?$(e).then(r=>{r.code===0&&(this.$emit("update:dialogVisible",!1),this.$emit("confirm",!0),f("\u53D1\u5E03\u6210\u529F"))}):C(e,e.id).then(r=>{r.code===0&&(this.$emit("update:dialogVisible",!1),this.$emit("confirm",!0),f("\u4FEE\u6539\u6210\u529F"))})}})}}},M=Object.assign(U,{setup(t){const e=y({data:{},fileList:[]}),r=u=>{O(u.file).then(({data:l})=>{e.data.img=l})};return(u,l)=>{const b=d("iconifyIconOnline"),V=d("el-upload"),n=d("el-form-item"),p=d("el-input"),g=d("el-date-picker"),c=d("el-cascader"),_=d("el-button"),v=d("el-form");return D(),j("div",null,[a(v,{ref:"gameRef",model:i(e).data,"label-width":"auto",rules:u.rules},{default:o(()=>[a(n,{label:"\u56FE\u7247\u4E0A\u4F20",prop:"img",required:""},{default:o(()=>[a(V,{class:"upload-demo flex",limit:1,name:"image",action:"","http-request":r,"file-list":i(e).fileList,"list-type":"picture"},{default:o(()=>[k("div",Y,[a(b,{icon:"plus"})])]),_:1},8,["file-list"])]),_:1}),a(n,{prop:"name",label:"\u8D5B\u4E8B\u540D\u79F0",required:""},{default:o(()=>[a(p,{modelValue:i(e).data.name,"onUpdate:modelValue":l[0]||(l[0]=s=>i(e).data.name=s)},null,8,["modelValue"])]),_:1}),a(n,{prop:"name",label:"\u4E3B\u529E\u65B9",required:""},{default:o(()=>[a(p,{modelValue:i(e).data.organizer,"onUpdate:modelValue":l[1]||(l[1]=s=>i(e).data.organizer=s)},null,8,["modelValue"])]),_:1}),a(n,{prop:"game_time",label:"\u6BD4\u8D5B\u65F6\u95F4",required:""},{default:o(()=>[a(g,{modelValue:i(e).data.game_time,"onUpdate:modelValue":l[2]||(l[2]=s=>i(e).data.game_time=s),type:"datetime",placeholder:"\u9009\u62E9\u6BD4\u8D5B\u65F6\u95F4","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),a(n,{prop:"sign_up_time",label:"\u62A5\u540D\u622A\u6B62\u65F6\u95F4",required:""},{default:o(()=>[a(g,{modelValue:i(e).data.sign_up_time,"onUpdate:modelValue":l[3]||(l[3]=s=>i(e).data.sign_up_time=s),placeholder:"\u9009\u62E9\u62A5\u540D\u622A\u6B62\u65F6\u95F4","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),a(n,{prop:"subject",label:"\u7ADE\u8D5B\u79D1\u76EE",required:""},{default:o(()=>[a(c,{modelValue:i(e).data.subject,"onUpdate:modelValue":l[4]||(l[4]=s=>i(e).data.subject=s),options:u.subject,placeholder:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u79D1\u76EE"},null,8,["modelValue","options"])]),_:1}),a(n,{prop:"level",label:"\u7ADE\u8D5B\u7EA7\u522B",required:""},{default:o(()=>[a(c,{modelValue:i(e).data.level,"onUpdate:modelValue":l[5]||(l[5]=s=>i(e).data.level=s),options:u.level,placeholder:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u7EA7\u522B"},null,8,["modelValue","options"])]),_:1}),a(n,null,{default:o(()=>[a(_,{type:"primary",onClick:u.clickAddGame},{default:o(()=>[G]),_:1},8,["onClick"]),a(_,{type:"danger",onClick:u.cancel},{default:o(()=>[S]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])])}}});var N=q(M,[["__scopeId","data-v-2c8e50ec"]]),I=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}));export{N as a,B as g,I as i,z as r};
