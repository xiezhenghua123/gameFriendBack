import{i as b,a as V,e as q}from"./gameManage.3b649b30.js";import{s as c}from"./user.8465d1e2.js";import{_ as v,o as y,p as k,H as a,S as i,q as j,J as _,I as n}from"./index.c2b63836.js";const x={emits:["confirm"],data(){return{gameData:{data:{img:"",name:"",organizer:"",game_time:"",sign_up_time:"",subject:"",level:"",content:""},fileList:[]},level:[{label:"\u6821\u7EA7",value:"\u6821\u7EA7"},{label:"\u7701\u7EA7",value:"\u7701\u7EA7"},{label:"\u56FD\u5BB6\u7EA7",value:"\u56FD\u5BB6\u7EA7"}],subject:[{label:"\u7406\u79D1",value:"\u7406\u79D1"},{label:"\u5DE5\u79D1",value:"\u5DE5\u79D1"},{label:"\u6587\u79D1",value:"\u6587\u79D1"}],rules:{content:{required:!0,message:"\u8BF7\u586B\u5199\u8D5B\u4E8B\u8BE6\u60C5",trigger:"change"},img:{required:!0,message:"\u8BF7\u4E0A\u4F20\u6D77\u62A5",trigger:"change"},name:{required:!0,message:"\u8BF7\u8F93\u5165\u8D5B\u4E8B\u540D\u79F0",trigger:"change"},organizer:{required:!0,message:"\u8BF7\u8F93\u5165\u4E3B\u529E\u65B9",trigger:"change"},sign_up_time:{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u540D\u65F6\u95F4",trigger:"change"},game_time:{required:!0,message:"\u8BF7\u9009\u62E9\u6BD4\u8D5B\u65F6\u95F4",trigger:"change"},subject:{required:!0,message:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u79D1\u76EE",trigger:"change"},level:{required:!0,message:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u7EA7\u522B",trigger:"change"}},operation:"add"}},props:{initData:{type:Object}},watch:{initData:{handler(o){if(JSON.stringify(o)!=="{}"){for(let e in o)e=="level"||e=="subject"?this.gameData.data[e]=[o[e]]:this.gameData.data=o;this.gameData.fileList=[{url:JSON.parse(o.img)[0]}],this.operation="edit"}else this.operation="add",this.gameData.data={},this.gameData.fileList=[]},immediate:!0}},methods:{httpRequest(o){b(o.file).then(({data:e})=>{this.gameData.data.img=e})},cancel(){this.$emit("cancel",!1)},clickAddGame(){this.$refs.gameRef.validate(o=>{if(o){const e={};for(let r in this.gameData.data)r=="img"?e[r]=JSON.stringify([this.gameData.data[r]]):e[r]=this.gameData.data[r].toString();e.publisher="1",this.operation==="add"?V(e).then(r=>{r.code===0&&(this.$emit("confirm",!0),c("\u53D1\u5E03\u6210\u529F"))}):q(e,e.id).then(r=>{r.code===0&&(this.$emit("confirm",!0),c("\u4FEE\u6539\u6210\u529F"))})}})}}},U={class:"upload-icon mr-10"},Y=_("\u63D0\u4EA4"),C=_("\u53D6\u6D88");function N(o,e,r,O,t,s){const f=n("iconifyIconOnline"),D=n("el-upload"),m=n("el-form-item"),d=n("el-input"),u=n("el-date-picker"),g=n("el-cascader"),p=n("el-button"),h=n("el-form");return y(),k("div",null,[a(h,{ref:"gameRef",model:t.gameData.data,"label-width":"auto",rules:t.rules},{default:i(()=>[a(m,{label:"\u56FE\u7247\u4E0A\u4F20",prop:"img",required:""},{default:i(()=>[a(D,{class:"upload-demo flex",limit:1,name:"image",action:"","http-request":s.httpRequest,"file-list":t.gameData.fileList,"list-type":"picture"},{default:i(()=>[j("div",U,[a(f,{icon:"plus"})])]),_:1},8,["http-request","file-list"])]),_:1}),a(m,{prop:"name",label:"\u8D5B\u4E8B\u540D\u79F0",required:""},{default:i(()=>[a(d,{modelValue:t.gameData.data.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.gameData.data.name=l)},null,8,["modelValue"])]),_:1}),a(m,{prop:"name",label:"\u4E3B\u529E\u65B9",required:""},{default:i(()=>[a(d,{modelValue:t.gameData.data.organizer,"onUpdate:modelValue":e[1]||(e[1]=l=>t.gameData.data.organizer=l)},null,8,["modelValue"])]),_:1}),a(m,{prop:"game_time",label:"\u6BD4\u8D5B\u65F6\u95F4",required:""},{default:i(()=>[a(u,{modelValue:t.gameData.data.game_time,"onUpdate:modelValue":e[2]||(e[2]=l=>t.gameData.data.game_time=l),type:"datetime",placeholder:"\u9009\u62E9\u6BD4\u8D5B\u65F6\u95F4","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),a(m,{prop:"sign_up_time",label:"\u62A5\u540D\u622A\u6B62\u65F6\u95F4",required:""},{default:i(()=>[a(u,{modelValue:t.gameData.data.sign_up_time,"onUpdate:modelValue":e[3]||(e[3]=l=>t.gameData.data.sign_up_time=l),placeholder:"\u9009\u62E9\u62A5\u540D\u622A\u6B62\u65F6\u95F4","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),a(m,{prop:"subject",label:"\u7ADE\u8D5B\u79D1\u76EE",required:""},{default:i(()=>[a(g,{modelValue:t.gameData.data.subject,"onUpdate:modelValue":e[4]||(e[4]=l=>t.gameData.data.subject=l),options:t.subject,placeholder:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u79D1\u76EE"},null,8,["modelValue","options"])]),_:1}),a(m,{prop:"level",label:"\u7ADE\u8D5B\u7EA7\u522B",required:""},{default:i(()=>[a(g,{modelValue:t.gameData.data.level,"onUpdate:modelValue":e[5]||(e[5]=l=>t.gameData.data.level=l),options:t.level,placeholder:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u7EA7\u522B"},null,8,["modelValue","options"])]),_:1}),a(m,{prop:"content",label:"\u8D5B\u4E8B\u8BE6\u60C5",required:""},{default:i(()=>[a(d,{modelValue:t.gameData.data.content,"onUpdate:modelValue":e[6]||(e[6]=l=>t.gameData.data.content=l),type:"textarea"},null,8,["modelValue"])]),_:1}),a(m,null,{default:i(()=>[a(p,{type:"primary",onClick:s.clickAddGame},{default:i(()=>[Y]),_:1},8,["onClick"]),a(p,{type:"danger",onClick:s.cancel},{default:i(()=>[C]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])])}var z=v(x,[["render",N],["__scopeId","data-v-3f1cc828"]]);export{z as default};
